<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Empresas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

</head>
<body>
    <div class="empresas-main-container">
        <h1 class="empresas-title">Registro de Empresas</h1>
        
        <div id="empresas-message"></div>

        <form id="empresaForm" class="empresas-fields-container">
            <div class="empresas-left-section">
                <div class="empresas-form-group">
                    <label for="nombre" class="empresas-label">Nombre de la empresa:</label>
                    <input type="text" id="nombre" placeholder="Nombre de la empresa" required autocomplete="off">
                </div>
                <div class="empresas-form-group">
                    <label for="rut" class="empresas-label">RUT de la empresa:</label>
                    <input type="text" id="rut" placeholder="RUT de la empresa (Ej: 76.123.456-7)" required autocomplete="off">
                </div>
                <button type="submit" class="empresas-register-btn">Registrar</button>
            </div>
            <div class="empresas-right-section">
                <div class="empresas-form-group">
                    <label for="buscarNombre" class="empresas-label">Buscar empresa:</label>
                    <input type="text" id="buscarNombre" placeholder="Buscar por nombre" autocomplete="off">
                </div>
                <div class="empresas-form-group">
                    <label for="buscarRut" class="empresas-label">Buscar RUT:</label>
                    <input type="text" id="buscarRut" placeholder="Buscar por RUT" autocomplete="off">
                </div>
            </div>
        </form>

        <table id="empresasTable" class="empresas-table">
            <thead>
                <tr>
                    <th>Nombre de la empresa</th>
                    <th>RUT de la empresa</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="empresasBody">
            </tbody>
        </table>

        <div class="empresas-pagination" id="pagination">
            <div class="empresas-pagination-info" id="paginationInfo">
            </div>
            <div class="empresas-pagination-controls">
                <button id="prevBtn">Anterior</button>
                <div class="empresas-page-numbers" id="pageNumbers"></div>
                <button id="nextBtn">Siguiente</button>
            </div>
        </div>

        <div class="empresas-actions-menu">
            <button id="actionsBtn">Acciones <i class="fas fa-angle-right"></i></button>
            <div id="actionsMenu" class="empresas-dropdown-menu">
                <a href="#" id="downloadAll">Descargar todos los registros</a>
                <a href="#" id="downloadPage">Descargar hoja actual</a>
                <a href="#" id="downloadTemplate">Descargar formato para importar</a>
                <a href="#" id="importExcel">Importar Excel</a>
            </div>
        </div>

        <input type="file" id="fileUpload" style="display:none;" accept=".xlsx, .xls">

        <div id="empresas-loading" class="empresas-loading">
            <div class="empresas-loading-spinner"></div>
            <div class="empresas-loading-text">Procesando...</div>
        </div>

        <div id="empresas-toast" class="empresas-toast"></div>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeEditModal">&times;</span>
            <h2>Editar Empresa</h2>
            <form id="editForm">
                <input type="hidden" id="editId">
                <div class="modal-form-group">
                    <label for="editNombre">Nombre de la empresa:</label>
                    <input type="text" id="editNombre" required>
                </div>
                <div class="modal-form-group">
                    <label for="editRut">RUT de la empresa:</label>
                    <input type="text" id="editRut" required>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="modal-btn modal-btn-secondary" id="cancelEdit">Cancelar</button>
                    <button type="submit" class="modal-btn modal-btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeDeleteModal">&times;</span>
            <h2>Eliminar Empresa</h2>
            <p class="delete-modal-text" id="deleteText"></p>
            <div class="modal-buttons">
                <button type="button" class="modal-btn modal-btn-secondary" id="cancelDelete">No</button>
                <button type="button" class="modal-btn modal-btn-danger" id="confirmDelete">SÃ­</button>
            </div>
        </div>
    </div>

    <div id="historyModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeHistory">&times;</span>
            <h2 id="historyTitle">HISTORIAL EMPRESA</h2>
            <hr>
            <div id="historyContent"></div>
            <div class="modal-buttons">
                <button type="button" class="modal-btn modal-btn-secondary" id="closeHistoryBtn">Cerrar</button>
            </div>
        </div>
    </div>
    
</body>
</html>